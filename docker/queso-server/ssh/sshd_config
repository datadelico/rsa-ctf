# /etc/ssh/sshd_config para queso-server
# Configuración restrictiva para CTF

# Direcciones y puertos
Port 22
AddressFamily inet
ListenAddress 0.0.0.0

# Opciones básicas de servidor
Protocol 2
HostKey /etc/ssh/ssh_host_rsa_key
HostKey /etc/ssh/ssh_host_ecdsa_key
HostKey /etc/ssh/ssh_host_ed25519_key

# Autenticación
PermitRootLogin no
PubkeyAuthentication yes
PasswordAuthentication no
PermitEmptyPasswords no
ChallengeResponseAuthentication no
UsePAM no

# Solo permitir el usuario queso
AllowUsers queso

# Archivos y directorios
AuthorizedKeysFile .ssh/authorized_keys
StrictModes no

# Restricciones
X11Forwarding no
AllowAgentForwarding no
AllowTcpForwarding no
GatewayPorts no
PermitTunnel no
PermitUserEnvironment no

# Activar banner con mensaje de CTF
Banner /etc/ssh/banner
PrintMotd yes
PrintLastLog yes

# Logging
SyslogFacility AUTH
LogLevel DEBUG3

# Otros ajustes de seguridad
MaxAuthTries 3
LoginGraceTime 30
MaxStartups 3:50:10